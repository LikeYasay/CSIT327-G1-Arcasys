{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'users/css/register.css' %}" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
{% endblock %}

{% block content %}
<div class="register-container">

  <div class="register-left">
    <header class="register-header">
      <div class="logo-section">
        <img src="{% static 'shared/images/CIT_LOGO.png' %}" alt="CIT Logo" class="logo" />
        <div class="logo-text">
          <h1>MARKETING ARCHIVE</h1>
          <p>Event Management System</p>
        </div>
      </div>
      <a href="{% url 'marketing:landing' %}" class="back-link">‚Üê Back</a>
    </header>
    <div class="register-card">
      <h1>Welcome</h1>
      <p class="description">Enter your details to create an account as staff.</p>

      <!-- Django messages -->
      {% if messages %}
        <ul class="messages">
          {% for message in messages %}
            <li class="{{ message.tags }}">{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      <!-- Register Form -->
      <form method="POST" autocomplete="off">
        {% csrf_token %}

        <!-- Hidden fake fields for autofill prevention -->
        <input type="text" name="fake_username" style="display:none">
        <input type="password" name="fake_password" style="display:none">

        <div class="name-fields">
          <div class="field">
            <label for="first_name">First Name</label>
            <input 
              type="text" 
              name="first_name" 
              id="first_name" 
              placeholder="Enter your first name" 
              required 
              autocomplete="given-name"
              readonly onfocus="this.removeAttribute('readonly')"
            >
          </div>
          <div class="field">
            <label for="last_name">Last Name</label>
            <input 
              type="text" 
              name="last_name" 
              id="last_name" 
              placeholder="Enter your last name" 
              required 
              autocomplete="family-name"
              readonly onfocus="this.removeAttribute('readonly')"
            >
          </div>
        </div>

        <label for="email">Email</label>
        <input 
          type="email" 
          name="email" 
          id="email" 
          placeholder="Enter your email" 
          required 
          autocomplete="email"
          readonly onfocus="this.removeAttribute('readonly')"
        >

        <label for="password">Password</label>
        <div class="password-wrapper">
          <input 
            type="password" 
            name="password" 
            id="password" 
            placeholder="Enter your password" 
            required 
            autocomplete="new-password"
            readonly onfocus="this.removeAttribute('readonly')"
          >
          <span class="toggle-password">
            <i class="fas fa-eye-slash" id="togglePasswordIcon"></i>
          </span>
        </div>

        <label for="confirm_password">Confirm Password</label>
        <div class="password-wrapper">
          <input 
            type="password" 
            name="confirm_password" 
            id="confirm_password" 
            placeholder="Confirm your password" 
            required 
            autocomplete="new-password"
            readonly onfocus="this.removeAttribute('readonly')"
          >
          <span class="toggle-password">
            <i class="fas fa-eye-slash" id="toggleConfirmPasswordIcon"></i>
          </span>
        </div>

        <button type="submit" class="btn-register">Sign up</button>
      </form>

      <p class="signup-text">
        Already have an account? <a href="{% url 'users:login' %}">Login</a>
      </p>
    </div>
  </div>

  <div class="register-right">
    <img src="{% static 'marketing/images/Library.jpg' %}" alt="Campus Building">
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    // Password visibility toggles
    const togglePwd = document.getElementById("togglePasswordIcon");
    const pwdInput = document.getElementById("password");
    if (togglePwd && pwdInput) {
      togglePwd.addEventListener("click", function() {
        const type = pwdInput.getAttribute("type") === "password" ? "text" : "password";
        pwdInput.setAttribute("type", type);
        this.classList.toggle("fa-eye-slash");
        this.classList.toggle("fa-eye");
      });
    }

    const toggleConfirm = document.getElementById("toggleConfirmPasswordIcon");
    const confirmInput = document.getElementById("confirm_password");
    if (toggleConfirm && confirmInput) {
      toggleConfirm.addEventListener("click", function() {
        const type = confirmInput.getAttribute("type") === "password" ? "text" : "password";
        confirmInput.setAttribute("type", type);
        this.classList.toggle("fa-eye-slash");
        this.classList.toggle("fa-eye");
      });
    }
  });
</script>
{% endblock %}