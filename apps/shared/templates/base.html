{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Marketing Archive{% endblock title %}</title>
    {% load tz %}
    <link rel="stylesheet" href="{% static 'shared/css/style.css' %}?v={{ now|date:'U' }}">
    {% block extra_css %}{% endblock extra_css %}
    <link
      rel="icon"
      type="image/png"
      href="{% static 'shared/images/CIT_LOGO.png' %}"
    />
  </head>

  <body>
    <div class="page-wrapper">

      <!-- HEADER / NAVBAR -->
      <header class="navbar">
        <div class="logo-section">
          <img
            src="{% static 'shared/images/CIT_LOGO.png' %}"
            alt="CIT Logo"
            class="logo"
          />
          <div class="logo-text">
            <h1>MARKETING ARCHIVE</h1>
            <p>Event Management System</p>
          </div>
        </div>

        <div class="nav-right">
          <nav class="nav-links">
            <ul>
              {% if user.is_authenticated %}
                {% if user.isUserAdmin or user.is_superuser %}
                  <!-- ADMIN NAVBAR -->
                  <li><a href="{% url 'events:admin_approval' %}">Approve Accounts</a></li>
                  <li><a href="{% url 'events:backup_dashboard' %}">Backup Management</a></li>
                  <li><a href="{% url 'events:events' %}">Events</a></li> <!-- FIXED -->
                {% elif user.isUserStaff %}
                  <!-- STAFF NAVBAR -->
                  <li><a href="{% url 'events:events' %}">Events</a></li> <!-- FIXED -->
                {% endif %}
                
                <li class="user-welcome-item">
                  <span class="user-welcome">Welcome, {{ user.UserFullName }}</span>
                </li>
              {% else %}
                <!-- PUBLIC NAVBAR (Viewers) -->
                <li><a href="/#about">About</a></li>
                <li><a href="{% url 'events:events' %}">Events</a></li>
                <li><a href="{% url 'marketing:contact' %}">Contact Us</a></li>
              {% endif %}
            </ul>
          </nav>

          <div class="auth-buttons">
            {% if user.is_authenticated %}
                <a href="{% url 'users:logout' %}" class="btn logout">Logout</a>
            {% else %}
                <a href="{% url 'users:register' %}" class="btn signup">Signup</a>
                <a href="{% url 'users:login' %}" class="btn login">Login</a>
            {% endif %}
          </div>
        </div>
      </header>

      <!-- MAIN CONTENT -->
      <main>
        {% block content %}{% endblock content %}
      </main>

      <!-- FOOTER -->
      <footer class="footer">
        <div class="footer-left">
          <p>
            © 2025 CIT–U | ARCASYS: Marketing Archive Manager. All rights reserved.
          </p>
        </div>
        <div class="footer-right">
          {% if not user.is_authenticated %}
            <!-- PUBLIC FOOTER -->
            <a href="/#about">About</a>
            <a href="{% url 'events:events' %}">Events</a>
            <a href="{% url 'marketing:contact' %}">Contact Us</a>
          {% else %}
            <!-- AUTHENTICATED USER FOOTER -->
            {% if user.isUserAdmin or user.is_superuser %}
              <a href="{% url 'events:admin_approval' %}">Approve Accounts</a>
              <a href="{% url 'events:add_event' %}">Add Events</a> <!-- FIXED -->
            {% elif user.isUserStaff %}
              <a href="{% url 'events:add_event' %}">Add Events</a> <!-- FIXED -->
            {% endif %}
          {% endif %}
        </div>
      </footer>
    </div>

    <!-- ✅ Active Navbar Link Script -->
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        const currentPath = window.location.pathname;
        document.querySelectorAll(".nav-links a").forEach(link => {
          if (link.pathname === currentPath) {
            link.classList.add("active");
            console.log(link.pathname, currentPath)
          }
        })
      });
    </script>
  </body>
</html>
